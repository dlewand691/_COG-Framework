{"version":3,"sources":["lib/reaction/index.js"],"names":["Object","defineProperty","exports","value","context_1","require","REACTION_ID","curId","Reaction","host","succinctList","succinctMap","id","prototype","track","fn","args","_i","arguments","length","default","enter","apply","leave","dispose","_this","forEach","succinct","removeSubscribe","addSuccinct","push"],"mappings":"AAAAA,OAAOC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C,EAAEC,OAAO,IAAT,EAA7C;AACA,IAAIC,YAAYC,QAAQ,YAAR,CAAhB;AACA,IAAIC,cAAc,UAAlB;AACA,IAAIC,QAAQ,CAAZ;AACA,IAAIC,WAAY,YAAY;AACxB,aAASA,QAAT,CAAkBC,IAAlB,EAAwB;AACpB,aAAKA,IAAL,GAAYA,IAAZ;AACA,aAAKC,YAAL,GAAoB,EAApB;AACA,aAAKC,WAAL,GAAmB,EAAnB;AACA,aAAKC,EAAL,GAAUN,cAAeC,OAAzB;AACH;AACDC,aAASK,SAAT,CAAmBC,KAAnB,GAA2B,UAAUC,EAAV,EAAc;AACrC,YAAIC,OAAO,EAAX;AACA,aAAK,IAAIC,KAAK,CAAd,EAAiBA,KAAKC,UAAUC,MAAhC,EAAwCF,IAAxC,EAA8C;AAC1CD,iBAAKC,KAAK,CAAV,IAAeC,UAAUD,EAAV,CAAf;AACH;AACDb,kBAAUgB,OAAV,CAAkBC,KAAlB,CAAwB,IAAxB;AACAN,WAAGO,KAAH,CAAS,KAAK,CAAd,EAAiBN,IAAjB;AACAZ,kBAAUgB,OAAV,CAAkBG,KAAlB;AACH,KARD;AASAf,aAASK,SAAT,CAAmBW,OAAnB,GAA6B,YAAY;AACrC,YAAIC,QAAQ,IAAZ;AACA,aAAKd,WAAL,GAAmB,IAAnB;AACA,aAAKD,YAAL,CAAkBgB,OAAlB,CAA0B,UAAUC,QAAV,EAAoB;AAC1CA,wBAAYA,SAASC,eAAT,CAAyBH,KAAzB,CAAZ;AACH,SAFD;AAGH,KAND;AAOAjB,aAASK,SAAT,CAAmBgB,WAAnB,GAAiC,UAAUF,QAAV,EAAoB;AACjD,YAAI,KAAKhB,WAAL,CAAiBgB,SAASf,EAA1B,CAAJ,EACI;AACJ,aAAKD,WAAL,CAAiBgB,SAASf,EAA1B,IAAgC,IAAhC;AACA,aAAKF,YAAL,CAAkBoB,IAAlB,CAAuBH,QAAvB;AACH,KALD;AAMA,WAAOnB,QAAP;AACH,CA9Be,EAAhB;AA+BAN,QAAQkB,OAAR,GAAkBZ,QAAlB","file":"index.js","sourceRoot":"/Users/sheweichun/opensource/succinct/packages/succinct","sourcesContent":["Object.defineProperty(exports, \"__esModule\", { value: true });\nvar context_1 = require(\"../context\");\nvar REACTION_ID = 'reaction';\nvar curId = 0;\nvar Reaction = (function () {\n    function Reaction(host) {\n        this.host = host;\n        this.succinctList = [];\n        this.succinctMap = {};\n        this.id = REACTION_ID + (curId++);\n    }\n    Reaction.prototype.track = function (fn) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        context_1.default.enter(this);\n        fn.apply(void 0, args);\n        context_1.default.leave();\n    };\n    Reaction.prototype.dispose = function () {\n        var _this = this;\n        this.succinctMap = null;\n        this.succinctList.forEach(function (succinct) {\n            succinct && succinct.removeSubscribe(_this);\n        });\n    };\n    Reaction.prototype.addSuccinct = function (succinct) {\n        if (this.succinctMap[succinct.id])\n            return;\n        this.succinctMap[succinct.id] = true;\n        this.succinctList.push(succinct);\n    };\n    return Reaction;\n}());\nexports.default = Reaction;\n"]}