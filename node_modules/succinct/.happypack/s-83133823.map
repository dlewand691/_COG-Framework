{"version":3,"sources":["es/reaction/index.js"],"names":["Context","REACTION_ID","curId","Reaction","host","succinctList","succinctMap","id","prototype","track","fn","args","_i","arguments","length","enter","apply","leave","dispose","_this","forEach","succinct","removeSubscribe","addSuccinct","push"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,YAApB;AACA,IAAIC,cAAc,UAAlB;AACA,IAAIC,QAAQ,CAAZ;AACA,IAAIC,WAAY,YAAY;AACxB,aAASA,QAAT,CAAkBC,IAAlB,EAAwB;AACpB,aAAKA,IAAL,GAAYA,IAAZ;AACA,aAAKC,YAAL,GAAoB,EAApB;AACA,aAAKC,WAAL,GAAmB,EAAnB;AACA,aAAKC,EAAL,GAAUN,cAAeC,OAAzB;AACH;AACDC,aAASK,SAAT,CAAmBC,KAAnB,GAA2B,UAAUC,EAAV,EAAc;AACrC,YAAIC,OAAO,EAAX;AACA,aAAK,IAAIC,KAAK,CAAd,EAAiBA,KAAKC,UAAUC,MAAhC,EAAwCF,IAAxC,EAA8C;AAC1CD,iBAAKC,KAAK,CAAV,IAAeC,UAAUD,EAAV,CAAf;AACH;AACDZ,gBAAQe,KAAR,CAAc,IAAd;AACAL,WAAGM,KAAH,CAAS,KAAK,CAAd,EAAiBL,IAAjB;AACAX,gBAAQiB,KAAR;AACH,KARD;AASAd,aAASK,SAAT,CAAmBU,OAAnB,GAA6B,YAAY;AACrC,YAAIC,QAAQ,IAAZ;AACA,aAAKb,WAAL,GAAmB,IAAnB;AACA,aAAKD,YAAL,CAAkBe,OAAlB,CAA0B,UAAUC,QAAV,EAAoB;AAC1CA,wBAAYA,SAASC,eAAT,CAAyBH,KAAzB,CAAZ;AACH,SAFD;AAGH,KAND;AAOAhB,aAASK,SAAT,CAAmBe,WAAnB,GAAiC,UAAUF,QAAV,EAAoB;AACjD,YAAI,KAAKf,WAAL,CAAiBe,SAASd,EAA1B,CAAJ,EACI;AACJ,aAAKD,WAAL,CAAiBe,SAASd,EAA1B,IAAgC,IAAhC;AACA,aAAKF,YAAL,CAAkBmB,IAAlB,CAAuBH,QAAvB;AACH,KALD;AAMA,WAAOlB,QAAP;AACH,CA9Be,EAAhB;AA+BA,eAAeA,QAAf","file":"index.js","sourceRoot":"/Users/sheweichun/opensource/succinct/packages/succinct","sourcesContent":["import Context from '../context';\nvar REACTION_ID = 'reaction';\nvar curId = 0;\nvar Reaction = (function () {\n    function Reaction(host) {\n        this.host = host;\n        this.succinctList = [];\n        this.succinctMap = {};\n        this.id = REACTION_ID + (curId++);\n    }\n    Reaction.prototype.track = function (fn) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        Context.enter(this);\n        fn.apply(void 0, args);\n        Context.leave();\n    };\n    Reaction.prototype.dispose = function () {\n        var _this = this;\n        this.succinctMap = null;\n        this.succinctList.forEach(function (succinct) {\n            succinct && succinct.removeSubscribe(_this);\n        });\n    };\n    Reaction.prototype.addSuccinct = function (succinct) {\n        if (this.succinctMap[succinct.id])\n            return;\n        this.succinctMap[succinct.id] = true;\n        this.succinctList.push(succinct);\n    };\n    return Reaction;\n}());\nexport default Reaction;\n"]}