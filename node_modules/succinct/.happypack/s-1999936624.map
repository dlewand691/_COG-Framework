{"version":3,"sources":["es/model/index.js"],"names":["IDENTITY","Succinc","Context","initialSuccinc","value","enhancerModel","target","key","descriptor","des","configurable","enumerable","get","currentContext","getContext","set","newValue","Model","bind"],"mappings":"AAAA,SAASA,QAAT,QAAyB,qBAAzB;AACA,OAAOC,OAAP,MAAoB,aAApB;AACA,OAAOC,OAAP,MAAoB,YAApB;AACA,SAASC,cAAT,CAAwBC,KAAxB,EAA+B;AAC3B,QAAIA,MAAMJ,QAAN,CAAJ,EACI;AACJI,UAAMJ,QAAN,IAAkB,IAAIC,OAAJ,EAAlB;AACH;AACD;AACA;AACA,SAASI,aAAT,CAAuBC,MAAvB,EAA+BF,KAA/B,EAAsCG,GAAtC,EAA2CC,UAA3C,EAAuD;AACnD;AACA;AACA;AACAL,mBAAeC,KAAf;AACA,QAAIK,MAAM;AACNC,sBAAc,IADR;AAENC,oBAAYH,WAAWG,UAFjB;AAGNC,aAAK,eAAY;AACb,gBAAIC,iBAAiBX,QAAQY,UAAR,EAArB;AACA,mBAAO,KAAKd,QAAL,EAAeY,GAAf,CAAmBL,GAAnB,EAAwBM,cAAxB,CAAP;AACH,SANK;AAONE,aAAK,aAAUC,QAAV,EAAoB;AACrB,iBAAKhB,QAAL,EAAee,GAAf,CAAmB,IAAIT,MAAJ,CAAWU,QAAX,CAAnB;AACH;AATK,KAAV;AAWA,WAAOP,GAAP;AACH;AACD,eAAe,SAASQ,KAAT,CAAeX,MAAf,EAAuB;AAClC,WAAOD,cAAca,IAAd,CAAmB,IAAnB,EAAyBZ,MAAzB,CAAP;AACH","file":"index.js","sourceRoot":"/Users/sheweichun/opensource/succinct/packages/succinct","sourcesContent":["import { IDENTITY } from '../commons/constant';\nimport Succinc from '../succinct';\nimport Context from '../context';\nfunction initialSuccinc(value) {\n    if (value[IDENTITY])\n        return;\n    value[IDENTITY] = new Succinc();\n}\n// function enhancerModel<T>(target: new (state: any) => T, value: any);\n// function enhancerModel<T>(target: new (state: any) => T, value: any, key: string, descriptor: Descriptor);\nfunction enhancerModel(target, value, key, descriptor) {\n    // if (key && descriptor) {\n    // }\n    // return new target(value); \n    initialSuccinc(value);\n    var des = {\n        configurable: true,\n        enumerable: descriptor.enumerable,\n        get: function () {\n            var currentContext = Context.getContext();\n            return this[IDENTITY].get(key, currentContext);\n        },\n        set: function (newValue) {\n            this[IDENTITY].set(new target(newValue));\n        }\n    };\n    return des;\n}\nexport default function Model(target) {\n    return enhancerModel.bind(null, target);\n}\n"]}